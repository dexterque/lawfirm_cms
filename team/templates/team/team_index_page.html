{% extends "base_subpage.html" %}
{% load wagtailcore_tags wagtailimages_tags %}

{% block page_content %}
<div class="team-content" style="padding:30px 0;">
    <div class="team-filters" style="display:flex;align-items:center;gap:15px;margin-bottom:20px;flex-wrap:wrap;">
        {% comment %} Determine active button by request.path {% endcomment %}
        <a href="/zhubanlvshi/" style="padding:8px 16px;border:1px solid #ddd;border-radius:18px;color:#333;text-decoration:none;{% if '/zhubanlvshi/' in request.path %}background:#fff;border-color:#bb2924;color:#bb2924;{% endif %}">主办律师</a>
        <a href="/lvshizhurenzhuli/" style="padding:8px 16px;border:1px solid #ddd;border-radius:18px;color:#333;text-decoration:none;{% if '/lvshizhurenzhuli/' in request.path %}background:#fff;border-color:#bb2924;color:#bb2924;{% endif %}">律师主任助理</a>
        <a href="/lvshiyewuzhuli/" style="padding:8px 16px;border:1px solid #ddd;border-radius:18px;color:#333;text-decoration:none;{% if '/lvshiyewuzhuli/' in request.path %}background:#fff;border-color:#bb2924;color:#bb2924;{% endif %}">律师业务助理</a>
        <form method="get" action="" style="margin-left:auto;display:flex;align-items:center;gap:8px;">
            <input type="text" name="q" placeholder="搜索..." style="height:34px;border:1px solid #ddd;border-radius:17px;padding:0 12px;outline:none;">
            <button type="submit" style="height:34px;border:0;background:#bb2924;color:#fff;border-radius:17px;padding:0 16px;cursor:pointer;">搜索</button>
        </form>
    </div>

    {% if members_with_photo %}
    {% with featured=members_with_photo|first %}
    <div class="featured-member" style="display:flex;gap:20px;align-items:center;margin-bottom:30px;flex-wrap:wrap;">
        <div style="flex:0 0 320px;max-width:320px;">
            {% if featured.photo %}
            {% image featured.photo fill-360x430 as feat_img %}
            <img src="{{ feat_img.url }}" alt="{{ featured.title }}" style="width:100%;height:auto;border-radius:10px;">
            {% else %}
            <div style="width:100%;height:430px;background:#f5f5f5;border-radius:10px;display:flex;align-items:center;justify-content:center;color:#999;">暂无照片</div>
            {% endif %}
        </div>
        <div style="flex:1;min-width:260px;">
            <h2 style="margin:0 0 10px 0;font-size:26px;color:#333;">{{ featured.title }}</h2>
            <p style="margin:0 0 12px 0;color:#666;font-size:16px;">{{ featured.position }}</p>
            <a href="{% pageurl featured %}" style="display:inline-block;padding:10px 18px;border:1px solid #bb2924;border-radius:4px;color:#bb2924;text-decoration:none;">查看更多 ></a>
        </div>
    </div>
    {% endwith %}
    {% endif %}

    <div class="team-categories" style="display:block;">
        {% comment %} If a role-specific URL is visited, only show that category; otherwise show all {% endcomment %}
        {% if '/zhubanlvshi/' in request.path %}
            {% with members=team_host %}
            <section class="team-category" style="margin-bottom:36px;">
                <h2 style="margin:0;font-size:22px;color:#333;">主办律师</h2>
                {% if members %}
                <div class="team-grid" style="display:flex;flex-wrap:wrap;gap:24px;">
                    {% for member in members %}
                    <div class="team-member" style="width:calc(25% - 18px);min-width:220px;background:#fff;border-radius:10px;border:1px solid #eee;padding:16px;text-align:center;box-shadow:0 4px 12px rgba(0,0,0,0.04);">
                        <a href="{% pageurl member %}" style="text-decoration:none;color:#333;display:block;">
                            {% if member.photo %}
                            {% image member.photo fill-200x200 as member_img %}
                            <img src="{{ member_img.url }}" alt="{{ member.title }}" style="width:160px;height:160px;object-fit:cover;border-radius:50%;margin-bottom:12px;">
                            {% else %}
                            <div style="width:160px;height:160px;background:#f5f5f5;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 12px auto;color:#999;">暂无照片</div>
                            {% endif %}
                            <h3 style="margin:0 0 6px 0;font-size:18px;">{{ member.title }}</h3>
                            {% if member.position %}
                            <p style="margin:0 0 10px 0;color:#666;font-size:14px;">{{ member.position }}</p>
                            {% endif %}
                        </a>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <div style="padding:20px;color:#999;">暂无主办律师，敬请期待...</div>
                {% endif %}
            </section>
            {% endwith %}
        {% elif '/lvshizhurenzhuli/' in request.path %}
            {% with members=team_chief_assistant %}
            <section class="team-category" style="margin-bottom:36px;">
                <h2 style="margin:0;font-size:22px;color:#333;">律师主任助理</h2>
                {% if members %}
                <div class="team-grid" style="display:flex;flex-wrap:wrap;gap:24px;">
                    {% for member in members %}
                    <div class="team-member" style="width:calc(25% - 18px);min-width:220px;background:#fff;border-radius:10px;border:1px solid #eee;padding:16px;text-align:center;box-shadow:0 4px 12px rgba(0,0,0,0.04);">
                        <a href="{% pageurl member %}" style="text-decoration:none;color:#333;display:block;">
                            {% if member.photo %}
                            {% image member.photo fill-200x200 as member_img %}
                            <img src="{{ member_img.url }}" alt="{{ member.title }}" style="width:160px;height:160px;object-fit:cover;border-radius:50%;margin-bottom:12px;">
                            {% else %}
                            <div style="width:160px;height:160px;background:#f5f5f5;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 12px auto;color:#999;">暂无照片</div>
                            {% endif %}
                            <h3 style="margin:0 0 6px 0;font-size:18px;">{{ member.title }}</h3>
                            {% if member.position %}
                            <p style="margin:0 0 10px 0;color:#666;font-size:14px;">{{ member.position }}</p>
                            {% endif %}
                        </a>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <div style="padding:20px;color:#999;">暂无律师主任助理，敬请期待...</div>
                {% endif %}
            </section>
            {% endwith %}
        {% elif '/lvshiyewuzhuli/' in request.path %}
            {% with members=team_business_assistant %}
            <section class="team-category" style="margin-bottom:36px;">
                <h2 style="margin:0;font-size:22px;color:#333;">律师业务助理</h2>
                {% if members %}
                <div class="team-grid" style="display:flex;flex-wrap:wrap;gap:24px;">
                    {% for member in members %}
                    <div class="team-member" style="width:calc(25% - 18px);min-width:220px;background:#fff;border-radius:10px;border:1px solid #eee;padding:16px;text-align:center;box-shadow:0 4px 12px rgba(0,0,0,0.04);">
                        <a href="{% pageurl member %}" style="text-decoration:none;color:#333;display:block;">
                            {% if member.photo %}
                            {% image member.photo fill-200x200 as member_img %}
                            <img src="{{ member_img.url }}" alt="{{ member.title }}" style="width:160px;height:160px;object-fit:cover;border-radius:50%;margin-bottom:12px;">
                            {% else %}
                            <div style="width:160px;height:160px;background:#f5f5f5;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 12px auto;color:#999;">暂无照片</div>
                            {% endif %}
                            <h3 style="margin:0 0 6px 0;font-size:18px;">{{ member.title }}</h3>
                            {% if member.position %}
                            <p style="margin:0 0 10px 0;color:#666;font-size:14px;">{{ member.position }}</p>
                            {% endif %}
                        </a>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <div style="padding:20px;color:#999;">暂无律师业务助理，敬请期待...</div>
                {% endif %}
            </section>
            {% endwith %}
        {% else %}
            {% comment %} Render all categories when no specific role path is visited {% endcomment %}
            {% for cat_name, members in team_categories.items %}
            <section class="team-category" style="margin-bottom:36px;">
                <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:18px;">
                    <h2 style="margin:0;font-size:22px;color:#333;">{{ cat_name }}</h2>
                    <a href="/zhuanyetuandui/" style="color:#999;font-size:14px;text-decoration:none;">查看更多</a>
                </div>
                {% if members %}
                <div class="team-grid" style="display:flex;flex-wrap:wrap;gap:24px;">
                    {% for member in members %}
                    <div class="team-member" style="width:calc(25% - 18px);min-width:220px;background:#fff;border-radius:10px;border:1px solid #eee;padding:16px;text-align:center;box-shadow:0 4px 12px rgba(0,0,0,0.04);">
                        <a href="{% pageurl member %}" style="text-decoration:none;color:#333;display:block;">
                            {% if member.photo %}
                            {% image member.photo fill-200x200 as member_img %}
                            <img src="{{ member_img.url }}" alt="{{ member.title }}" style="width:160px;height:160px;object-fit:cover;border-radius:50%;margin-bottom:12px;">
                            {% else %}
                            <div style="width:160px;height:160px;background:#f5f5f5;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 12px auto;color:#999;">暂无照片</div>
                            {% endif %}
                            <h3 style="margin:0 0 6px 0;font-size:18px;">{{ member.title }}</h3>
                            {% if member.position %}
                            <p style="margin:0 0 10px 0;color:#666;font-size:14px;">{{ member.position }}</p>
                            {% endif %}
                        </a>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <div style="padding:20px;color:#999;">暂无{{ cat_name }}，敬请期待...</div>
                {% endif %}
            </section>
            {% endfor %}

            {% if team_others %}
            <section class="team-category" style="margin-bottom:36px;">
                <h2 style="font-size:22px;color:#333;margin-bottom:18px;">其他成员</h2>
                <div class="team-grid" style="display:flex;flex-wrap:wrap;gap:24px;">
                    {% for member in team_others %}
                    <div class="team-member" style="width:calc(25% - 18px);min-width:220px;background:#fff;border-radius:10px;border:1px solid #eee;padding:16px;text-align:center;box-shadow:0 4px 12px rgba(0,0,0,0.04);">
                        <a href="{% pageurl member %}" style="text-decoration:none;color:#333;display:block;">
                            {% if member.photo %}
                            {% image member.photo fill-200x200 as member_img %}
                            <img src="{{ member_img.url }}" alt="{{ member.title }}" style="width:160px;height:160px;object-fit:cover;border-radius:50%;margin-bottom:12px;">
                            {% else %}
                            <div style="width:160px;height:160px;background:#f5f5f5;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 12px auto;color:#999;">暂无照片</div>
                            {% endif %}
                            <h3 style="margin:0 0 6px 0;font-size:18px;">{{ member.title }}</h3>
                            {% if member.position %}
                            <p style="margin:0 0 10px 0;color:#666;font-size:14px;">{{ member.position }}</p>
                            {% endif %}
                        </a>
                    </div>
                    {% endfor %}
                </div>
            </section>
            {% endif %}
        {% endif %}
    </div>
</div>
{% endblock %}
